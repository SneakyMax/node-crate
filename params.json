{"name":"Node-crate","tagline":"Node.js base DB-Driver for CRATE (www.crate.io)","body":"node-crate\r\n==========\r\n\r\n\r\n \r\n[![Dependency Status](https://gemnasium.com/megastef/node-crate.png)](https://gemnasium.com/megastef/node-crate)\r\n&nbsp;[![Build Status](https://drone.io/github.com/megastef/node-crate/status.png)](https://drone.io/github.com/megastef/node-crate/latest)\r\n\r\nThis is an independent node.js driver implementation for CRATE using the _sql endpoint REST API.\r\n\r\n[Crate Data](http://crate.io) \"Easy to scale real time SQL data store\" \r\n\r\nPlease note: Crate is a trademark of Crate Technology Gmbh, registered in the E.U. and in other countries.\r\n\r\n\r\n## Features: \r\n1. Async Interface\r\n2. Conversion from rows to array of JSON entities\r\n3. Automatic build of SQL statements from JSON or full control with SQL String with placeholders and arguments \r\n4. Support for BLOB objects (e.g. for image uploads) with inbuilt key generation\r\n\r\n## Known limitation\r\nNested JSON objects are currently not supported to generate SQL statements (e.g. for insert/update).\r\nWe might change this soon. \r\n\r\n## Installation\r\n\r\n```\r\nnpm install node-crate\r\n```\r\n\r\n## Test\r\nWhen a crate instance is running on http://localhost:4200 you can use [lab](https://github.com/spumko/lab) based test (test/test.js).\r\nTest actions: create table, insert, select, update, delete and drop table.  \r\n\r\n```\r\nnpm test \r\n```\r\n\r\n## Usage\r\n\r\n```js\r\nvar crate = require('node-crate');\r\ncrate.connect ('localhost', 4200)\r\n// or crate.connect ('http://localhost:4200')\r\n// to use multiple nodes in round robin crate.connect ('http://host1:4200 http://host2:4200')\r\n// to use https crate.connect ('https://host1:4200 https://host2:4200')\r\ncrate.execute (\"select * from tweets where text like ? and retweed=? limit 1\", ['Frohe Ostern%', true]).success (function (res){\r\n\t// res.json is an array with JSON object, with column names as properties, TIMESTAMP is converted to Date for crate V0.38+\r\n\t// res.cols are column names\r\n\t// res.rows values as array of arrays\r\n\t// res.duration execution time of query\r\n\t// res.rowcount number of rows\r\n\t// res.col_types type of column, e.g. res.col_types[i] == crate.type.TIMESTAMP\r\n\tconsole.log ('Success', res.json, res.duration, res.rowcount, res.cols, res.rows)\r\n})\r\n\r\n```\r\n### execute (sql, args)\r\n```js\r\ncrate.execute (\"select * from tweets where text like ?\", ['%crate%']).success (console.log).error(console.error) \r\n```\r\n### insert (tableName, jsonEntity)\r\n```js\r\ncrate.insert ('mytable', {columnName1: 'value1', columnName2: 'value2'}).success (console.log)\r\n```\r\n\r\n### create (tableName, where)\r\n```js\r\nvar scheme = {book: {id: 'integer primary key', title: 'string', author: 'string'}}\r\ncrate.create (scheme).success (console.log)\r\n```\r\n\r\n### drop (tableName)\r\n```js\r\ncrate.drop ('mytable').success (console.log)\r\n```\r\n\r\n\r\n### update (tableName, jsonEntity, whereClause)\r\n```js\r\ncrate.update ('mytable', {columnName1: 'value1', columnName2: 'value2'}, 'columnName3=5').success (console.log)\r\n```\r\n\r\n\r\n### delete (tableName, where)\r\n```js\r\ncrate.delete ('mytable', \"columnName1='value1'\").success (console.log)\r\n```\r\n\r\n## BLOB's\r\n\r\n\r\n### createBlob (tableName, replicas, shards)\r\n```\r\ncrate.createBlobTable ('images',1,3).success(console.log).error(console.log)\r\n```\r\n### insertBlob (tableName, buffer)\r\n```js\r\ncrate.insertBlob ('images', buffer).success (console.log)\r\n```\r\n### insertBlobFile (tableName, fileName)\r\nThe callback returns the required haskey to get the image with getBlob.\r\n\r\n```js\r\ncrate.insertBlobFile ('images', './test.png').success (function (hashKey) {\r\n    console.log (\"Assigned hashkey\": hashKey)\r\n})\r\n```\r\n### getBlob (tableName, hashKey)\r\nThe callback return a buffer as result - callback (buffer)\r\n```js\r\ncrate.getBlob ('f683e0c9abcbf518704af66c6195bfd3ff121f09').success (function (data) {\r\n  \tfs.writeFileSync ('test.gif', data)\r\n})\r\n```\r\n\r\n# Use in Webbrowsers JavaScript\r\n\r\nThe intention was to use it with node.js on the server side, but it is possible to make it available in a web browser using [browserify](https://github.com/substack/node-browserify). \r\n```\r\nnpm run bundle\r\n```\r\n\r\nThe resulting automatically generated using drone.io. You can refer to this file:\r\n\r\n```\r\n<script src=\"https://drone.io/github.com/megastef/node-crate/files/bundle.js\"></script>\r\n```\r\n\r\nThen you might be able to use it inside of an CRATE-Plug-In HTML page: \r\n\r\n```\r\n<script src=\"bundle.js\"></script>\r\n<script>\r\n  var crate = require('node-crate');\r\n  crate.execute ('select * from tweets limit 10').success (window.alert)\r\n</script>\r\n```\r\n\r\n## Roadmap\r\n1. We plan to support in future waterline.js as ORM on top of this base driver. \r\n\r\n## License\r\n\r\nThe MIT License(MIT)\r\nCopyright(C) 2014 by Stefan Thies, Igor Likhomanov\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy\r\nof this software and associated documentation files(the \"Software\"), to deal\r\nin the Software without restriction, including without limitation the rights\r\nto use, copy, modify, merge, publish, distribute, sublicense, and / or sell\r\ncopies of the Software, and to permit persons to whom the Software is\r\nfurnished to do so, subject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in\r\nall copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE\r\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\nTHE SOFTWARE.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}